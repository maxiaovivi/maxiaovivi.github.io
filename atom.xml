<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>潇潇潇的博客</title>
  
  <subtitle>君应有语：“渺万里层云，千山暮雪，只影向谁去”</subtitle>
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2023-03-08T18:24:35.546Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>潇潇潇</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>seaship</title>
    <link href="http://example.com/2023/03/06/seaship/"/>
    <id>http://example.com/2023/03/06/seaship/</id>
    <published>2023-03-06T21:18:24.000Z</published>
    <updated>2023-03-08T18:24:35.546Z</updated>
    
    <content type="html"><![CDATA[<h1 id="在SeaShip数据集上验证YoloV5"><a href="#在SeaShip数据集上验证YoloV5" class="headerlink" title="在SeaShip数据集上验证YoloV5"></a>在SeaShip数据集上验证YoloV5</h1><p>操作系统： ArchLinux</p><p>需要代理</p><h2 id="1-conda安装配置"><a href="#1-conda安装配置" class="headerlink" title="1.conda安装配置"></a>1.conda安装配置</h2><p>已经完成的小伙伴可以直接跳过</p><h3 id="安装Anaconda"><a href="#安装Anaconda" class="headerlink" title="安装Anaconda"></a>安装Anaconda</h3><h4 id="yay安装"><a href="#yay安装" class="headerlink" title="yay安装"></a>yay安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay -S anaconda</span><br></pre></td></tr></table></figure><h4 id="激活Anaconda环境"><a href="#激活Anaconda环境" class="headerlink" title="激活Anaconda环境"></a>激活Anaconda环境</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /opt/anaconda/bin/activate root</span><br></pre></td></tr></table></figure><h4 id="关闭Anaconda环境"><a href="#关闭Anaconda环境" class="headerlink" title="关闭Anaconda环境"></a>关闭Anaconda环境</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /opt/anaconda/bin/deactivate root</span><br></pre></td></tr></table></figure><h3 id="Anaconda-常用命令"><a href="#Anaconda-常用命令" class="headerlink" title="Anaconda 常用命令"></a>Anaconda 常用命令</h3><h4 id="管理Conda"><a href="#管理Conda" class="headerlink" title="管理Conda"></a>管理Conda</h4><h5 id="检测Conda版本"><a href="#检测Conda版本" class="headerlink" title="检测Conda版本"></a>检测Conda版本</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda --veriosn</span><br></pre></td></tr></table></figure><h5 id="升级当前版本的conda"><a href="#升级当前版本的conda" class="headerlink" title="升级当前版本的conda"></a>升级当前版本的conda</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda update conda</span><br></pre></td></tr></table></figure><h4 id="管理环境"><a href="#管理环境" class="headerlink" title="管理环境"></a>管理环境</h4><h5 id="查看环境目录"><a href="#查看环境目录" class="headerlink" title="查看环境目录"></a>查看环境目录</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda env list</span><br></pre></td></tr></table></figure><h5 id="创建环境"><a href="#创建环境" class="headerlink" title="创建环境"></a>创建环境</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda create -n （环境名） （包名）</span><br></pre></td></tr></table></figure><h5 id="打开环境"><a href="#打开环境" class="headerlink" title="打开环境"></a>打开环境</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">conda activate （环境名）</span><br><span class="line">或</span><br><span class="line">source activate （环境名）</span><br></pre></td></tr></table></figure><h5 id="退出环境"><a href="#退出环境" class="headerlink" title="退出环境"></a>退出环境</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source deactivate</span><br></pre></td></tr></table></figure><h5 id="卸载环境"><a href="#卸载环境" class="headerlink" title="卸载环境"></a>卸载环境</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda remove --name （环境名） --all</span><br></pre></td></tr></table></figure><h5 id="将环境导入YAML文件当中"><a href="#将环境导入YAML文件当中" class="headerlink" title="将环境导入YAML文件当中"></a>将环境导入YAML文件当中</h5><blockquote><p>分享代码时需要将自己的环境也同时分享，故应该将package的环境导入到environment.yaml中</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">导出conda环境，默认路径在主文件夹下</span></span><br><span class="line">conda env export &gt; environment.yaml</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">通过yaml信息创建环境</span></span><br><span class="line">conda env create -f emvironment.yaml  </span><br></pre></td></tr></table></figure><h4 id="管理包"><a href="#管理包" class="headerlink" title="管理包"></a>管理包</h4><h5 id="查看包"><a href="#查看包" class="headerlink" title="查看包"></a>查看包</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda list</span><br></pre></td></tr></table></figure><h5 id="更新包"><a href="#更新包" class="headerlink" title="更新包"></a>更新包</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda upgrade --all</span><br></pre></td></tr></table></figure><h5 id="搜索包"><a href="#搜索包" class="headerlink" title="搜索包"></a>搜索包</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda search name</span><br></pre></td></tr></table></figure><h5 id="安装包"><a href="#安装包" class="headerlink" title="安装包"></a>安装包</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">conda install （包名）</span><br><span class="line">or</span><br><span class="line">pip install (包名)</span><br></pre></td></tr></table></figure><h5 id="卸载包"><a href="#卸载包" class="headerlink" title="卸载包"></a>卸载包</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">conda remove (包名)</span><br><span class="line">or</span><br><span class="line">pip uninstall (包名)</span><br></pre></td></tr></table></figure><h2 id="2-下载数据集"><a href="#2-下载数据集" class="headerlink" title="2.下载数据集"></a>2.下载数据集</h2><h3 id="下载数据集"><a href="#下载数据集" class="headerlink" title="下载数据集"></a>下载数据集</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#下载地址</span><br><span class="line">http://www.lmars.whu.edu.cn/prof_web/shaozhenfeng/datasets/SeaShips%287000%29.zip</span><br></pre></td></tr></table></figure><p>下载好的数据集有这样三个文件，Annotations是保留xml文件，JPEGImages是图像文件，ImageSets下有Main文件夹中含有四个文本文件。</p><p><img src="https://s2.loli.net/2023/03/06/BtfL49SE8Jz5xQl.png" alt="image-20230306225111388"></p><p><img src="https://s2.loli.net/2023/03/06/uj5aLW2ys1XbG6c.png" alt="image-20230306225129542"></p><h2 id="3-环境配置以及源码下载"><a href="#3-环境配置以及源码下载" class="headerlink" title="3.环境配置以及源码下载"></a>3.环境配置以及源码下载</h2><h3 id="conda配置"><a href="#conda配置" class="headerlink" title="conda配置"></a>conda配置</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda creat -n yolov5 python=3.8</span><br></pre></td></tr></table></figure><h3 id="下载yolov5源码"><a href="#下载yolov5源码" class="headerlink" title="下载yolov5源码"></a>下载yolov5源码</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/ultralytics/yolov5.git</span><br><span class="line"></span><br><span class="line">cd yolov5</span><br><span class="line"></span><br><span class="line">pip install -r requirements.txt</span><br></pre></td></tr></table></figure><p>成功安装界面</p><p><img src="https://s2.loli.net/2023/03/08/oP6vpAf5Yqk9siw.png" alt="image-20230308130642687"></p><h2 id="4-数据集格式转化"><a href="#4-数据集格式转化" class="headerlink" title="4.数据集格式转化"></a>4.数据集格式转化</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd data</span><br></pre></td></tr></table></figure><p>将之前下载的数据集当中的Annotations与JPEGImage移动到该目录下</p><p>在同级目录下创建makedata.py，并运行：  （PS：记得改成自己的绝对路径，相对路径容易没有经验的同学容易报错还不知道怎么改）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">xml_file_path = <span class="string">&#x27;/home/自己的绝对路径/data/Annotations/&#x27;</span>       <span class="comment"># *********检查和自己的xml文件夹名称是否一致*********</span></span><br><span class="line">images_file_path = <span class="string">&#x27;/home/自己的绝对路径/data/JPEGImages/&#x27;</span>  <span class="comment"># *******检查和自己的图像文件夹名称是否一致********</span></span><br><span class="line"><span class="comment"># 最好不要用&quot;images&quot;作文件夹名字，因为后续会对图片进行划分，我命名的新文件夹叫&quot;images&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ******改成自己的类别名称***********</span></span><br><span class="line">classes = [<span class="string">&quot;ore carrier&quot;</span>, <span class="string">&quot;general cargo ship&quot;</span>, <span class="string">&quot;bulk cargo carrier&quot;</span>, <span class="string">&quot;container ship&quot;</span>, <span class="string">&quot;fishing boat&quot;</span>, <span class="string">&quot;passenger ship&quot;</span>]</span><br><span class="line"><span class="comment"># 数据集划分比例，训练集75%，验证集15%，测试集15%</span></span><br><span class="line">train_percent = <span class="number">0.7</span></span><br><span class="line">val_percent = <span class="number">0.15</span></span><br><span class="line">test_percent = <span class="number">0.15</span></span><br><span class="line"><span class="comment"># 此处不要改动，只是创一个临时文件夹</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">&#x27;data/temp_labels/&#x27;</span>):</span><br><span class="line">    os.makedirs(<span class="string">&#x27;data/temp_labels/&#x27;</span>)</span><br><span class="line">txt_file_path = <span class="string">&#x27;data/temp_labels/&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convert</span>(<span class="params">size, box</span>):</span><br><span class="line">    dw = <span class="number">1.</span> / size[<span class="number">0</span>]</span><br><span class="line">    dh = <span class="number">1.</span> / size[<span class="number">1</span>]</span><br><span class="line">    x = (box[<span class="number">0</span>] + box[<span class="number">1</span>]) / <span class="number">2.0</span></span><br><span class="line">    y = (box[<span class="number">2</span>] + box[<span class="number">3</span>]) / <span class="number">2.0</span></span><br><span class="line">    w = box[<span class="number">1</span>] - box[<span class="number">0</span>]</span><br><span class="line">    h = box[<span class="number">3</span>] - box[<span class="number">2</span>]</span><br><span class="line">    x = x * dw</span><br><span class="line">    w = w * dw</span><br><span class="line">    y = y * dh</span><br><span class="line">    h = h * dh</span><br><span class="line">    <span class="keyword">return</span> x, y, w, h</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convert_annotations</span>(<span class="params">image_name</span>):</span><br><span class="line">    in_file = <span class="built_in">open</span>(xml_file_path + image_name + <span class="string">&#x27;.xml&#x27;</span>, encoding=<span class="string">&#x27;UTF-8&#x27;</span>)</span><br><span class="line">    out_file = <span class="built_in">open</span>(txt_file_path + image_name + <span class="string">&#x27;.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;UTF-8&#x27;</span>)</span><br><span class="line">    tree = ET.parse(in_file)</span><br><span class="line">    root = tree.getroot()</span><br><span class="line">    size = root.find(<span class="string">&#x27;size&#x27;</span>)</span><br><span class="line">    w = <span class="built_in">int</span>(size.find(<span class="string">&#x27;width&#x27;</span>).text)</span><br><span class="line">    h = <span class="built_in">int</span>(size.find(<span class="string">&#x27;height&#x27;</span>).text)</span><br><span class="line">    <span class="keyword">for</span> obj <span class="keyword">in</span> root.<span class="built_in">iter</span>(<span class="string">&#x27;object&#x27;</span>):</span><br><span class="line">        <span class="comment"># difficult = obj.find(&#x27;difficult&#x27;).text</span></span><br><span class="line">        cls = obj.find(<span class="string">&#x27;name&#x27;</span>).text</span><br><span class="line">        <span class="comment"># if cls not in classes or int(difficult) == 1:</span></span><br><span class="line">        <span class="comment">#     continue</span></span><br><span class="line">        <span class="keyword">if</span> cls <span class="keyword">not</span> <span class="keyword">in</span> classes == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        cls_id = classes.index(cls)</span><br><span class="line">        xmlbox = obj.find(<span class="string">&#x27;bndbox&#x27;</span>)</span><br><span class="line">        b = (<span class="built_in">float</span>(xmlbox.find(<span class="string">&#x27;xmin&#x27;</span>).text), <span class="built_in">float</span>(xmlbox.find(<span class="string">&#x27;xmax&#x27;</span>).text),</span><br><span class="line">             <span class="built_in">float</span>(xmlbox.find(<span class="string">&#x27;ymin&#x27;</span>).text), <span class="built_in">float</span>(xmlbox.find(<span class="string">&#x27;ymax&#x27;</span>).text))</span><br><span class="line">        bb = convert((w, h), b)</span><br><span class="line">        out_file.write(<span class="built_in">str</span>(cls_id) + <span class="string">&quot; &quot;</span> + <span class="string">&quot; &quot;</span>.join([<span class="built_in">str</span>(a) <span class="keyword">for</span> a <span class="keyword">in</span> bb]) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">total_xml = os.listdir(xml_file_path)</span><br><span class="line">num_xml = <span class="built_in">len</span>(total_xml)  <span class="comment"># XML文件总数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num_xml):</span><br><span class="line">    name = total_xml[i][:-<span class="number">4</span>]</span><br><span class="line">    convert_annotations(name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># *********************************************** #</span></span><br><span class="line"><span class="comment">#  parent folder</span></span><br><span class="line"><span class="comment">#  --data</span></span><br><span class="line"><span class="comment">#  ----images</span></span><br><span class="line"><span class="comment">#       ----train</span></span><br><span class="line"><span class="comment">#       ----val</span></span><br><span class="line"><span class="comment">#       ----test</span></span><br><span class="line"><span class="comment">#  ----labels</span></span><br><span class="line"><span class="comment">#       ----train</span></span><br><span class="line"><span class="comment">#       ----val</span></span><br><span class="line"><span class="comment">#       ----test</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_dir</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">&#x27;data/images/&#x27;</span>):</span><br><span class="line">        os.makedirs(<span class="string">&#x27;data/images/&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">&#x27;data/labels/&#x27;</span>):</span><br><span class="line">        os.makedirs(<span class="string">&#x27;data/labels/&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">&#x27;data/images/train/&#x27;</span>):</span><br><span class="line">        os.makedirs(<span class="string">&#x27;data/images/train&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">&#x27;data/images/val/&#x27;</span>):</span><br><span class="line">        os.makedirs(<span class="string">&#x27;data/images/val/&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">&#x27;data/images/test/&#x27;</span>):</span><br><span class="line">        os.makedirs(<span class="string">&#x27;data/images/test/&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">&#x27;data/labels/train/&#x27;</span>):</span><br><span class="line">        os.makedirs(<span class="string">&#x27;data/labels/train/&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">&#x27;data/labels/val/&#x27;</span>):</span><br><span class="line">        os.makedirs(<span class="string">&#x27;data/labels/val/&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">&#x27;data/labels/test/&#x27;</span>):</span><br><span class="line">        os.makedirs(<span class="string">&#x27;data/labels/test/&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># *********************************************** #</span></span><br><span class="line"><span class="comment"># 读取所有的txt文件</span></span><br><span class="line">create_dir()</span><br><span class="line">total_txt = os.listdir(txt_file_path)</span><br><span class="line">num_txt = <span class="built_in">len</span>(total_txt)</span><br><span class="line">list_all_txt = <span class="built_in">range</span>(num_txt)  <span class="comment"># 范围 range(0, num)</span></span><br><span class="line"></span><br><span class="line">num_train = <span class="built_in">int</span>(num_txt * train_percent)</span><br><span class="line">num_val = <span class="built_in">int</span>(num_txt * val_percent)</span><br><span class="line">num_test = num_txt - num_train - num_val</span><br><span class="line"></span><br><span class="line">train = random.sample(list_all_txt, num_train)</span><br><span class="line"><span class="comment"># train从list_all_txt取出num_train个元素</span></span><br><span class="line"><span class="comment"># 所以list_all_txt列表只剩下了这些元素：val_test</span></span><br><span class="line">val_test = [i <span class="keyword">for</span> i <span class="keyword">in</span> list_all_txt <span class="keyword">if</span> <span class="keyword">not</span> i <span class="keyword">in</span> train]</span><br><span class="line"><span class="comment"># 再从val_test取出num_val个元素，val_test剩下的元素就是test</span></span><br><span class="line">val = random.sample(val_test, num_val)</span><br><span class="line"><span class="comment"># 检查两个列表元素是否有重合的元素</span></span><br><span class="line"><span class="comment"># set_c = set(val_test) &amp; set(val)</span></span><br><span class="line"><span class="comment"># list_c = list(set_c)</span></span><br><span class="line"><span class="comment"># print(list_c)</span></span><br><span class="line"><span class="comment"># print(len(list_c))</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;训练集数目：&#123;&#125;, 验证集数目：&#123;&#125;,测试集数目：&#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">len</span>(train), <span class="built_in">len</span>(val), <span class="built_in">len</span>(val_test) - <span class="built_in">len</span>(val)))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> list_all_txt:</span><br><span class="line">    name = total_txt[i][:-<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">    srcImage = images_file_path + name + <span class="string">&#x27;.jpg&#x27;</span></span><br><span class="line">    srcLabel = txt_file_path + name + <span class="string">&#x27;.txt&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> i <span class="keyword">in</span> train:</span><br><span class="line">        dst_train_Image = <span class="string">&#x27;data/images/train/&#x27;</span> + name + <span class="string">&#x27;.jpg&#x27;</span></span><br><span class="line">        dst_train_Label = <span class="string">&#x27;data/labels/train/&#x27;</span> + name + <span class="string">&#x27;.txt&#x27;</span></span><br><span class="line">        shutil.copyfile(srcImage, dst_train_Image)</span><br><span class="line">        shutil.copyfile(srcLabel, dst_train_Label)</span><br><span class="line">    <span class="keyword">elif</span> i <span class="keyword">in</span> val:</span><br><span class="line">        dst_val_Image = <span class="string">&#x27;data/images/val/&#x27;</span> + name + <span class="string">&#x27;.jpg&#x27;</span></span><br><span class="line">        dst_val_Label = <span class="string">&#x27;data/labels/val/&#x27;</span> + name + <span class="string">&#x27;.txt&#x27;</span></span><br><span class="line">        shutil.copyfile(srcImage, dst_val_Image)</span><br><span class="line">        shutil.copyfile(srcLabel, dst_val_Label)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        dst_test_Image = <span class="string">&#x27;data/images/test/&#x27;</span> + name + <span class="string">&#x27;.jpg&#x27;</span></span><br><span class="line">        dst_test_Label = <span class="string">&#x27;data/labels/test/&#x27;</span> + name + <span class="string">&#x27;.txt&#x27;</span></span><br><span class="line">        shutil.copyfile(srcImage, dst_test_Image)</span><br><span class="line">        shutil.copyfile(srcLabel, dst_test_Label)</span><br><span class="line">shutil.rmtree(txt_file_path)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>运行可生成：</p><p><img src="https://s2.loli.net/2023/03/08/lK2miogJwuRHpQT.png" alt="image-20230308183703878"></p><p>注意这两个文件，之后要复制到其他地方去用。</p><p><img src="https://s2.loli.net/2023/03/08/tWGjl9ICH8Z2dX4.png"></p><p><img src="https://s2.loli.net/2023/03/08/xbC194UrF27HvhP.png" alt="image-20230308183715571"></p><h2 id="5-修改配置文件"><a href="#5-修改配置文件" class="headerlink" title="5. 修改配置文件"></a>5. 修改配置文件</h2><h3 id="修改读取配置文件"><a href="#修改读取配置文件" class="headerlink" title="修改读取配置文件"></a>修改读取配置文件</h3><p>在data目录下创建自己的数据集读取配置文件</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Train/val/test sets as 1) dir: path/to/imgs, 2) file: path/to/imgs.txt, or 3) list: [path/to/imgs1, path/to/imgs2, ..]</span></span><br><span class="line"><span class="comment"># path: ../datasets/VOC</span></span><br><span class="line"><span class="attr">train:</span> </span><br><span class="line">  <span class="bullet">-</span> <span class="string">/home/mxvivi/yolov5/yolov5/data/images/train/</span></span><br><span class="line"><span class="attr">val:</span> </span><br><span class="line">  <span class="bullet">-</span> <span class="string">/home/mxvivi/yolov5/yolov5/data/images/val/</span></span><br><span class="line"><span class="attr">test:</span> </span><br><span class="line">  <span class="bullet">-</span> <span class="string">/home/mxvivi/yolov5/yolov5/data/images/test/</span></span><br><span class="line"><span class="attr">nc:</span> <span class="number">6</span></span><br><span class="line"><span class="comment"># Classes</span></span><br><span class="line"><span class="attr">names:</span></span><br><span class="line">  <span class="attr">0:</span> <span class="string">ore</span> <span class="string">carrier</span></span><br><span class="line">  <span class="attr">1:</span> <span class="string">general</span> <span class="string">cargo</span> <span class="string">ship</span></span><br><span class="line">  <span class="attr">2:</span> <span class="string">bulk</span> <span class="string">cargo</span> <span class="string">carrier</span></span><br><span class="line">  <span class="attr">3:</span> <span class="string">container</span> <span class="string">ship</span></span><br><span class="line">  <span class="attr">4:</span> <span class="string">fishing</span> <span class="string">boat</span></span><br><span class="line">  <span class="attr">5:</span> <span class="string">passenger</span> <span class="string">ship</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="修改超参数"><a href="#修改超参数" class="headerlink" title="修改超参数"></a>修改超参数</h3><p>在data目录下创建文件 hyp.finetune.yaml （这个只是一个大概的值，可以通过wandb等网站调参）<a href="https://www.bilibili.com/video/BV1rM411Y7nZ/?spm_id_from=333.337.search-card.all.click&vd_source=a0550d3457cb01d47cf52af889fed3d3">推荐视频</a></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">lr0:</span> <span class="number">0.01</span>  <span class="comment"># 初始学习率 (SGD=1E-2, Adam=1E-3)</span></span><br><span class="line"><span class="attr">lrf:</span> <span class="number">0.2</span>  <span class="comment"># 循环学习率 (lr0 * lrf)</span></span><br><span class="line"><span class="attr">momentum:</span> <span class="number">0.937</span>  <span class="comment"># SGD momentum/Adam beta1 学习率动量</span></span><br><span class="line"><span class="attr">weight_decay:</span> <span class="number">0.0005</span>  <span class="comment"># 权重衰减系数 </span></span><br><span class="line"><span class="attr">warmup_epochs:</span> <span class="number">3.0</span>  <span class="comment"># 预热学习 (fractions ok)</span></span><br><span class="line"><span class="attr">warmup_momentum:</span> <span class="number">0.8</span>  <span class="comment"># 预热学习动量</span></span><br><span class="line"><span class="attr">warmup_bias_lr:</span> <span class="number">0.1</span>  <span class="comment"># 预热初始学习率</span></span><br><span class="line"><span class="attr">box:</span> <span class="number">0.05</span>  <span class="comment"># iou损失系数</span></span><br><span class="line"><span class="attr">cls:</span> <span class="number">0.5</span>  <span class="comment"># cls损失系数</span></span><br><span class="line"><span class="attr">cls_pw:</span> <span class="number">1.0</span>  <span class="comment"># cls BCELoss正样本权重</span></span><br><span class="line"><span class="attr">obj:</span> <span class="number">1.0</span>  <span class="comment"># 有无物体系数(scale with pixels)</span></span><br><span class="line"><span class="attr">obj_pw:</span> <span class="number">1.0</span>  <span class="comment"># 有无物体BCELoss正样本权重</span></span><br><span class="line"><span class="attr">iou_t:</span> <span class="number">0.20</span>  <span class="comment"># IoU训练时的阈值</span></span><br><span class="line"><span class="attr">anchor_t:</span> <span class="number">4.0</span>  <span class="comment"># anchor的长宽比（长:宽 = 4:1）</span></span><br><span class="line"><span class="comment"># anchors: 3  # 每个输出层的anchors数量(0 to ignore)</span></span><br><span class="line"><span class="comment">#以下系数是数据增强系数，包括颜色空间和图片空间</span></span><br><span class="line"><span class="attr">fl_gamma:</span> <span class="number">0.0</span>  <span class="comment"># focal loss gamma (efficientDet default gamma=1.5)</span></span><br><span class="line"><span class="attr">hsv_h:</span> <span class="number">0.015</span>  <span class="comment"># 色调 (fraction)</span></span><br><span class="line"><span class="attr">hsv_s:</span> <span class="number">0.7</span>  <span class="comment"># 饱和度 (fraction)</span></span><br><span class="line"><span class="attr">hsv_v:</span> <span class="number">0.4</span>  <span class="comment"># 亮度 (fraction)</span></span><br><span class="line"><span class="attr">degrees:</span> <span class="number">0.0</span>  <span class="comment"># 旋转角度 (+/- deg)</span></span><br><span class="line"><span class="attr">translate:</span> <span class="number">0.1</span>  <span class="comment"># 平移(+/- fraction)</span></span><br><span class="line"><span class="attr">scale:</span> <span class="number">0.5</span>  <span class="comment"># 图像缩放 (+/- gain)</span></span><br><span class="line"><span class="attr">shear:</span> <span class="number">0.0</span>  <span class="comment"># 图像剪切 (+/- deg)</span></span><br><span class="line"><span class="attr">perspective:</span> <span class="number">0.0</span>  <span class="comment"># 透明度 (+/- fraction), range 0-0.001</span></span><br><span class="line"><span class="attr">flipud:</span> <span class="number">0.0</span>  <span class="comment"># 进行上下翻转概率 (probability)</span></span><br><span class="line"><span class="attr">fliplr:</span> <span class="number">0.5</span>  <span class="comment"># 进行左右翻转概率 (probability)</span></span><br><span class="line"><span class="attr">mosaic:</span> <span class="number">1.0</span>  <span class="comment"># 进行Mosaic概率 (probability)</span></span><br><span class="line"><span class="attr">mixup:</span> <span class="number">0.0</span>  <span class="comment"># 进行图像混叠概率（即，多张图像重叠在一起） (probability)</span></span><br></pre></td></tr></table></figure><h3 id="下载初始权重文件"><a href="#下载初始权重文件" class="headerlink" title="下载初始权重文件"></a>下载初始权重文件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">在yolov5根目录下创建文件夹</span></span><br><span class="line">mkdir weights</span><br><span class="line">cd weights</span><br><span class="line">wget https://github.com/ultralytics/yolov5/releases/download/v7.0/yolov5s-seg.pt</span><br></pre></td></tr></table></figure><h3 id="配置训练文件"><a href="#配置训练文件" class="headerlink" title="配置训练文件"></a>配置训练文件</h3><p>修改至如图所示即可：</p><p><strong>data改成我们读取配置的路径</strong></p><p><strong>hyp改为我们超参数的文件的路径</strong></p><p><strong>bantch-size根据自己显存修改，显存不够就改小一点</strong></p><p><strong>device那里填显卡的编号，没有就用CPU，但会有亿点点慢 nvidia-smi可以查看显卡编号</strong></p><p><img src="https://s2.loli.net/2023/03/08/jEgzOhU3NVxkA4d.png" alt="image-20230308185813432"></p><h3 id="修改yoloV5s网络参数"><a href="#修改yoloV5s网络参数" class="headerlink" title="修改yoloV5s网络参数"></a>修改yoloV5s网络参数</h3><p>打开文件&#x2F;yolov5&#x2F;models&#x2F;yolov5s.yaml   修改为如图所示</p><p><img src="https://s2.loli.net/2023/03/08/PjhY7TLNHwVdRpK.png" alt="image-20230308190451232"></p><h2 id="6-训练模型"><a href="#6-训练模型" class="headerlink" title="6.训练模型"></a>6.训练模型</h2><h3 id="训练"><a href="#训练" class="headerlink" title="训练"></a>训练</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python train.py --data data/myshipvoc.yaml --weights weights/yolov5s-seg.pt --cfg models/yolov5s.yaml --hyp data/hyp.finetune.yaml --epochs <span class="number">70</span> --rect </span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>训练完成：</p><p><img src="https://s2.loli.net/2023/03/08/KlLBAMEdwC2npcq.png" alt="image-20230308191632425"></p><h3 id="查看效果"><a href="#查看效果" class="headerlink" title="查看效果"></a>查看效果</h3><p><img src="https://s2.loli.net/2023/03/08/StkpDJTfI1BjbPd.png" alt="confusion_matrix"></p><p><img src="https://s2.loli.net/2023/03/08/9kUZaVpBcoKYdL1.png" alt="F1_curve"></p><p><img src="https://s2.loli.net/2023/03/08/tGRMZLmFSlaTYOi.png" alt="PR_curve"></p><p><img src="https://s2.loli.net/2023/03/08/QKCNzIiwfrETcov.png" alt="R_curve"></p><p><img src="https://s2.loli.net/2023/03/08/RZ7lBKt4h9Evd31.jpg" alt="train_batch2"></p><p><img src="https://s2.loli.net/2023/03/08/lurOQWIDmVhBtA5.jpg" alt="val_batch0_pred"></p><h3 id="查看Recall率"><a href="#查看Recall率" class="headerlink" title="查看Recall率"></a>查看Recall率</h3><p><img src="https://s2.loli.net/2023/03/08/3I975PiQ6aYSspn.png" alt="image-20230308192105213"></p><p>训练70轮之后还在持续增加，在调整超参数后应该还有很大的进步空间</p><h2 id="谢谢观看"><a href="#谢谢观看" class="headerlink" title="谢谢观看"></a>谢谢观看</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;在SeaShip数据集上验证YoloV5&quot;&gt;&lt;a href=&quot;#在SeaShip数据集上验证YoloV5&quot; class=&quot;headerlink&quot; title=&quot;在SeaShip数据集上验证YoloV5&quot;&gt;&lt;/a&gt;在SeaShip数据集上验证YoloV5&lt;/h1&gt;&lt;</summary>
      
    
    
    
    <category term="计算机技术" scheme="http://example.com/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="计算机视觉 神经网络" scheme="http://example.com/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"/>
    
  </entry>
  
  <entry>
    <title>docker的简单使用（二）</title>
    <link href="http://example.com/2023/03/04/docker-2/"/>
    <id>http://example.com/2023/03/04/docker-2/</id>
    <published>2023-03-04T15:15:35.000Z</published>
    <updated>2023-03-05T22:43:09.828Z</updated>
    
    <content type="html"><![CDATA[<h1 id="docker的简单使用（二）"><a href="#docker的简单使用（二）" class="headerlink" title="docker的简单使用（二）"></a>docker的简单使用（二）</h1><h2 id="1-应用容器化"><a href="#1-应用容器化" class="headerlink" title="1.应用容器化"></a>1.应用容器化</h2><h3 id="主要步骤："><a href="#主要步骤：" class="headerlink" title="主要步骤："></a>主要步骤：</h3><ol><li>编写应用代码。</li><li>创建一个Dockerfile，其中包括了当前应用的描述，依赖以及该如何运行这个应用。</li><li>对该Dockerfile执行docker image build 命令。</li><li>等待Docker将应用程序构建到Docker镜像当中。</li></ol><h3 id="单体应用容器化"><a href="#单体应用容器化" class="headerlink" title="单体应用容器化"></a>单体应用容器化</h3><h4 id="获取代码"><a href="#获取代码" class="headerlink" title="获取代码"></a>获取代码</h4><p>从作者的GitHub库当中获取他的实例代码：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/nigelpoulton/psweb.git</span><br><span class="line"></span><br><span class="line">cd psweb</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看是否下载成功</span></span><br><span class="line">ls -l</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">如下表示</span></span><br><span class="line">-rw-r--r-- 1 mxvivi mxvivi  341  3月 4日 16:34 app.js</span><br><span class="line">-rw-r--r-- 1 mxvivi mxvivi  216  3月 4日 16:34 circle.yml</span><br><span class="line">-rw-r--r-- 1 mxvivi mxvivi  336  3月 4日 16:34 Dockerfile</span><br><span class="line">-rw-r--r-- 1 mxvivi mxvivi  403  3月 4日 16:34 package.json</span><br><span class="line">-rw-r--r-- 1 mxvivi mxvivi  455  3月 4日 16:34 README.md</span><br><span class="line">drwxr-xr-x 2 mxvivi mxvivi 4096  3月 4日 16:34 test</span><br><span class="line">drwxr-xr-x 2 mxvivi mxvivi 4096  3月 4日 16:34 views</span><br></pre></td></tr></table></figure><h4 id="分析Dockerfile"><a href="#分析Dockerfile" class="headerlink" title="分析Dockerfile"></a>分析Dockerfile</h4><p>在docker中，包含应用文件的目录通常被称之为Build Context。Dockerfile需要放在Build Context的根目录下。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看Dockerfile文件</span></span><br><span class="line">cat Dockerfile</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Test web-app to use with Pluralsight courses and Docker Deep Dive book</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Linux x64</span></span><br><span class="line">FROM alpine</span><br><span class="line"></span><br><span class="line">LABEL maintainer=&quot;nigelpoulton@hotmail.com&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Install Node and NPM</span></span><br><span class="line">RUN apk add --update nodejs npm curl</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Copy app to /src</span></span><br><span class="line">COPY . /src</span><br><span class="line"></span><br><span class="line">WORKDIR /src</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Install dependencies</span></span><br><span class="line">RUN  npm install</span><br><span class="line"></span><br><span class="line">EXPOSE 8080</span><br><span class="line"></span><br><span class="line">ENTRYPOINT [&quot;node&quot;, &quot;./app.js&quot;]</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>Dockerfile的两个作用：</p><ol><li>对当前应用的描述。</li><li>指导Docker完成容器化。</li></ol><p>每个Dockerfile文件的第一行都是FROM指令。FROM指令指定的镜像，会作为当前镜像的一个基础镜像层，当前镜像的剩余内容会在其之上构建。LABEL是维护者的说明，方便用户与其沟通。<em>RUN apk add –update nodejs npm curl</em>  是通过alpine镜像的apk包管理器安装 nodejs…  RUN指令执行以后会在alpine层之上新构建一个镜像层来存放这些应用。<em>COPY . &#x2F;src</em> 是从Build Context中的相关文件复制到了当前的镜像层中，并构建了一个新镜像层来存储。 当前含有三层镜像层了。</p><p>下一步，通过WORKDIR指令，为Dockerfile中尚未执行的指令设置工作目录。该目录与镜像有关，并会作为元数据记录到镜像的配置当中，但不再新建镜像层。</p><p>RUN npm install 会根据package.json中的配置信息，使用npm来安装相关的依赖包。npm会在前文设置的工作目录当中进行，并且在镜像当中新建镜像层来保持相关的依赖文件。</p><h4 id="容器化当前的应用-x2F-构建新的镜像"><a href="#容器化当前的应用-x2F-构建新的镜像" class="headerlink" title="容器化当前的应用&#x2F;构建新的镜像"></a>容器化当前的应用&#x2F;构建新的镜像</h4><p>在pswb的目录下执行：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">docker image build -t web:latest  . &lt;&lt;这个点一定要加，表面是在当前的目录构建的</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">打包完成</span></span><br><span class="line">Removing intermediate container c26ab47f95fe</span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">41ad2c0e9350</span></span><br><span class="line">Step 7/8 : EXPOSE 8080</span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">Running <span class="keyword">in</span> a47595f384d6</span></span><br><span class="line">Removing intermediate container a47595f384d6</span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">bc17aab3395d</span></span><br><span class="line">Step 8/8 : ENTRYPOINT [&quot;node&quot;, &quot;./app.js&quot;]</span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">Running <span class="keyword">in</span> e745f4c3be27</span></span><br><span class="line">Removing intermediate container e745f4c3be27</span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">83ba43fa9c04</span></span><br><span class="line">Successfully built 83ba43fa9c04</span><br><span class="line">Successfully tagged web:latest</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看</span></span><br><span class="line">docker image inspect web:lastest</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="推送镜像到DockerHub"><a href="#推送镜像到DockerHub" class="headerlink" title="推送镜像到DockerHub"></a>推送镜像到DockerHub</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">登录</span></span><br><span class="line">docker login</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">成功显示</span></span><br><span class="line">Username: maxiaovivi</span><br><span class="line">WARNING! Your password will be stored unencrypted in /home/mxvivi/.docker/config.json.</span><br><span class="line">Configure a credential helper to remove this warning. See</span><br><span class="line">https://docs.docker.com/engine/reference/commandline/login/#credentials-store</span><br><span class="line"></span><br><span class="line">Login Succeeded</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;docker的简单使用（二）&quot;&gt;&lt;a href=&quot;#docker的简单使用（二）&quot; class=&quot;headerlink&quot; title=&quot;docker的简单使用（二）&quot;&gt;&lt;/a&gt;docker的简单使用（二）&lt;/h1&gt;&lt;h2 id=&quot;1-应用容器化&quot;&gt;&lt;a href=</summary>
      
    
    
    
    <category term="计算机技术" scheme="http://example.com/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="计算机技术" scheme="http://example.com/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%8A%80%E6%9C%AF/"/>
    
  </entry>
  
  <entry>
    <title>飞花令——君</title>
    <link href="http://example.com/2023/03/04/shi/"/>
    <id>http://example.com/2023/03/04/shi/</id>
    <published>2023-03-04T14:06:35.000Z</published>
    <updated>2023-03-05T21:20:58.021Z</updated>
    
    <content type="html"><![CDATA[<h1 id="君-飞花令"><a href="#君-飞花令" class="headerlink" title="君 飞花令"></a>君 飞花令</h1><h2 id="将进酒"><a href="#将进酒" class="headerlink" title="将进酒"></a>将进酒</h2><p>唐 李白<br><strong>君不见，黄河之水天上来，奔流到海不复回。</strong><br><strong>君不见，高堂明镜悲白发，朝如青丝暮成雪。</strong><br>人生得意须尽欢，莫使金樽空对月。<br>天生我材必有用，千金散尽还复来。<br>烹羊宰牛且为乐，会须一饮三百杯。<br>岑夫子，丹丘生，将进酒，杯莫停。<br><strong>与君歌一曲，请君为我倾耳听。(倾耳听 一作：侧耳听)</strong><br>钟鼓馔玉不足贵，但愿长醉不愿醒。(不足贵 一作：何足贵；不愿醒 一作：不复醒)<br>古来圣贤皆寂寞，惟有饮者留其名。(古来 一作：自古；惟 通：唯)<br>陈王昔时宴平乐，斗酒十千恣欢谑。<br>主人何为言少钱，径须沽取对君酌。<br>五花马，千金裘，呼儿将出换美酒，与尔同销万古愁。</p><h2 id="关雎"><a href="#关雎" class="headerlink" title="关雎"></a>关雎</h2><p>先秦 佚名<br>关关雎鸠，在河之洲。<strong>窈窕淑女，君子好逑。</strong><br>参差荇菜，左右流之。窈窕淑女，寤寐求之。<br>求之不得，寤寐思服。悠哉悠哉，辗转反侧。<br>参差荇菜，左右采之。窈窕淑女，琴瑟友之。<br>参差荇菜，左右芼之。窈窕淑女，钟鼓乐之。</p><h2 id="长恨歌"><a href="#长恨歌" class="headerlink" title="长恨歌"></a>长恨歌</h2><p>唐 白居易<br>汉皇重色思倾国，御宇多年求不得。<br>杨家有女初长成，养在深闺人未识。<br><strong>天生丽质难自弃，一朝选在君王侧。</strong><br>回眸一笑百媚生，六宫粉黛无颜色。<br>春寒赐浴华清池，温泉水滑洗凝脂。<br>侍儿扶起娇无力，始是新承恩泽时。<br>云鬓花颜金步摇，芙蓉帐暖度春宵。<br><strong>春宵苦短日高起，从此君王不早朝。</strong><br>承欢侍宴无闲暇，春从春游夜专夜。<br>后宫佳丽三千人，三千宠爱在一身。<br>金屋妆成娇侍夜，玉楼宴罢醉和春。<br>姊妹弟兄皆列土，可怜光彩生门户。<br>遂令天下父母心，不重生男重生女。<br>骊宫高处入青云，仙乐风飘处处闻。<br><strong>缓歌慢舞凝丝竹，尽日君王看不足。</strong><br>渔阳鼙鼓动地来，惊破霓裳羽衣曲。</p><p>九重城阙烟尘生，千乘万骑西南行。<br>翠华摇摇行复止，西出都门百余里。<br>六军不发无奈何，宛转蛾眉马前死。<br>花钿委地无人收，翠翘金雀玉搔头。<br><strong>君王掩面救不得，回看血泪相和流。</strong><br>黄埃散漫风萧索，云栈萦纡登剑阁。<br>峨嵋山下少人行，旌旗无光日色薄。<br>蜀江水碧蜀山青，圣主朝朝暮暮情。<br>行宫见月伤心色，夜雨闻铃肠断声。<br>天旋日转回龙驭，到此踌躇不能去。<br>马嵬坡下泥土中，不见玉颜空死处。<br><strong>君臣相顾尽沾衣，东望都门信马归。</strong><br>归来池苑皆依旧，太液芙蓉未央柳。<br>芙蓉如面柳如眉，对此如何不泪垂。<br>春风桃李花开夜，秋雨梧桐叶落时。(花开夜 一作：花开日)<br>西宫南苑多秋草，落叶满阶红不扫。(南苑 一作：南内)<br>梨园弟子白发新，椒房阿监青娥老。<br>夕殿萤飞思悄然，孤灯挑尽未成眠。<br>迟迟钟鼓初长夜，耿耿星河欲曙天。<br>鸳鸯瓦冷霜华重，翡翠衾寒谁与共。<br>悠悠生死别经年，魂魄不曾来入梦。</p><p>临邛道士鸿都客，能以精诚致魂魄。<br><strong>为感君王辗转思，遂教方士殷勤觅。</strong><br>排空驭气奔如电，升天入地求之遍。<br>上穷碧落下黄泉，两处茫茫皆不见。<br>忽闻海上有仙山，山在虚无缥缈间。<br>楼阁玲珑五云起，其中绰约多仙子。<br>中有一人字太真，雪肤花貌参差是。<br>金阙西厢叩玉扃，转教小玉报双成。<br>闻道汉家天子使，九华帐里梦魂惊。<br>揽衣推枕起徘徊，珠箔银屏迤逦开。<br>云鬓半偏新睡觉，花冠不整下堂来。</p><p>风吹仙袂飘飖举，犹似霓裳羽衣舞。<br>玉容寂寞泪阑干，梨花一枝春带雨。(阑 通：栏)<br><strong>含情凝睇谢君王，一别音容两渺茫。</strong><br>昭阳殿里恩爱绝，蓬莱宫中日月长。<br>回头下望人寰处，不见长安见尘雾。<br>惟将旧物表深情，钿合金钗寄将去。<br>钗留一股合一扇，钗擘黄金合分钿。<br>但令心似金钿坚，天上人间会相见。</p><p>临别殷勤重寄词，词中有誓两心知。<br>七月七日长生殿，夜半无人私语时。<br>在天愿作比翼鸟，在地愿为连理枝。<br>天长地久有时尽，此恨绵绵无绝期。</p><h2 id="春江花夜月"><a href="#春江花夜月" class="headerlink" title="春江花夜月"></a>春江花夜月</h2><p>唐 张若虚<br>春江潮水连海平，海上明月共潮生。<br>滟滟随波千万里，何处春江无月明！<br>江流宛转绕芳甸，月照花林皆似霰。<br>空里流霜不觉飞，汀上白沙看不见。<br>江天一色无纤尘，皎皎空中孤月轮。<br>江畔何人初见月？江月何年初照人？<br>人生代代无穷已，江月年年只相似。(只相似 一作：望相似)<br>不知江月待何人，但见长江送流水。<br>白云一片去悠悠，青枫浦上不胜愁。<br>谁家今夜扁舟子？何处相思明月楼？<br>可怜楼上月徘徊，应照离人妆镜台。<br>玉户帘中卷不去，捣衣砧上拂还来。<br><strong>此时相望不相闻，愿逐月华流照君。</strong><br>鸿雁长飞光不度，鱼龙潜跃水成文。<br>昨夜闲潭梦落花，可怜春半不还家。<br>江水流春去欲尽，江潭落月复西斜。<br>斜月沉沉藏海雾，碣石潇湘无限路。<br>不知乘月几人归，落月摇情满江树。(落月 一作：落花)</p><h2 id="虞美人·春花秋月何时了"><a href="#虞美人·春花秋月何时了" class="headerlink" title="虞美人·春花秋月何时了"></a>虞美人·春花秋月何时了</h2><p>五代 李煜<br>春花秋月何时了？往事知多少。小楼昨夜又东风，故国不堪回首月明中。<br>雕栏玉砌应犹在，只是朱颜改。<strong>问君能有几多愁？恰似一江春水向东流。</strong>(栏 通：阑)</p><h2 id="蜀道难"><a href="#蜀道难" class="headerlink" title="蜀道难"></a>蜀道难</h2><p>唐 李白<br>噫吁嚱，危乎高哉！<br>蜀道之难，难于上青天！<br>蚕丛及鱼凫，开国何茫然！<br>尔来四万八千岁，不与秦塞通人烟。<br>西当太白有鸟道，可以横绝峨眉巅。<br>地崩山摧壮士死，然后天梯石栈相钩连。<br>上有六龙回日之高标，下有冲波逆折之回川。<br>黄鹤之飞尚不得过，猿猱欲度愁攀援。(攀援 一作：攀缘)<br>青泥何盘盘，百步九折萦岩峦。<br>扪参历井仰胁息，以手抚膺坐长叹。<br><strong>问君西游何时还？畏途巉岩不可攀。</strong><br>但见悲鸟号古木，雄飞雌从绕林间。<br>又闻子规啼夜月，愁空山。<br>蜀道之难，难于上青天，使人听此凋朱颜！<br>连峰去天不盈尺，枯松倒挂倚绝壁。<br>飞湍瀑流争喧豗，砯崖转石万壑雷。<br>其险也如此，嗟尔远道之人胡为乎来哉！(也如此 一作：也若此)<br>剑阁峥嵘而崔嵬，一夫当关，万夫莫开。<br>所守或匪亲，化为狼与豺。<br>朝避猛虎，夕避长蛇；磨牙吮血，杀人如麻。<br>锦城虽云乐，不如早还家。<br>蜀道之难，难于上青天，侧身西望长咨嗟！</p><h2 id="破阵子·为陈同甫赋壮词以寄之"><a href="#破阵子·为陈同甫赋壮词以寄之" class="headerlink" title="破阵子·为陈同甫赋壮词以寄之"></a>破阵子·为陈同甫赋壮词以寄之</h2><p>宋 辛弃疾<br>醉里挑灯看剑，梦回吹角连营。八百里分麾下炙，五十弦翻塞外声。沙场秋点兵。<br>马作的卢飞快，弓如霹雳弦惊。<strong>了却君王天下事，赢得生前身后名。可怜白发生！</strong></p><h2 id="白雪歌送武判官归京"><a href="#白雪歌送武判官归京" class="headerlink" title="白雪歌送武判官归京"></a>白雪歌送武判官归京</h2><p>唐 岑参<br>北风卷地白草折，胡天八月即飞雪。<br>忽如一夜春风来，千树万树梨花开。<br>散入珠帘湿罗幕，狐裘不暖锦衾薄。<br>将军角弓不得控，都护铁衣冷难着。(难着 一作：犹著)<br>瀚海阑干百丈冰，愁云惨淡万里凝。<br>中军置酒饮归客，胡琴琵琶与羌笛。<br>纷纷暮雪下辕门，风掣红旗冻不翻。<br><strong>轮台东门送君去，去时雪满天山路。</strong><br><strong>山回路转不见君，雪上空留马行处。</strong></p><h2 id="琵琶行"><a href="#琵琶行" class="headerlink" title="琵琶行"></a>琵琶行</h2><p>唐 白居易<br>浔阳江头夜送客，枫叶荻花秋瑟瑟。<br>主人下马客在船，举酒欲饮无管弦。<br>醉不成欢惨将别，别时茫茫江浸月。<br>忽闻水上琵琶声，主人忘归客不发。<br>寻声暗问弹者谁？琵琶声停欲语迟。<br>移船相近邀相见，添酒回灯重开宴。<br>千呼万唤始出来，犹抱琵琶半遮面。<br>转轴拨弦三两声，未成曲调先有情。<br>弦弦掩抑声声思，似诉平生不得志。（不得志 一作：不得意）<br>低眉信手续续弹，说尽心中无限事。<br>轻拢慢捻抹复挑，初为《霓裳》后《六幺》（六幺 一作：绿腰）。<br>大弦嘈嘈如急雨，小弦切切如私语。<br>嘈嘈切切错杂弹，大珠小珠落玉盘。<br>间关莺语花底滑，幽咽泉流冰下难。<br>冰泉冷涩弦凝绝，凝绝不通声暂歇。(暂歇 一作：渐歇)<br>别有幽愁暗恨生，此时无声胜有声。<br>银瓶乍破水浆迸，铁骑突出刀枪鸣。<br>曲终收拨当心画，四弦一声如裂帛。<br>东船西舫悄无言，唯见江心秋月白。<br>沉吟放拨插弦中，整顿衣裳起敛容。<br>自言本是京城女，家在虾蟆陵下住。<br>十三学得琵琶成，名属教坊第一部。<br>曲罢曾教善才服，妆成每被秋娘妒。<br>五陵年少争缠头，一曲红绡不知数。<br>钿头银篦击节碎，血色罗裙翻酒污。(银篦 一作：云篦)<br>今年欢笑复明年，秋月春风等闲度。<br>弟走从军阿姨死，暮去朝来颜色故。<br>门前冷落鞍马稀，老大嫁作商人妇。<br>商人重利轻别离，前月浮梁买茶去。<br>去来江口守空船，绕船月明江水寒。<br>夜深忽梦少年事，梦啼妆泪红阑干。<br>我闻琵琶已叹息，又闻此语重唧唧。<br>同是天涯沦落人，相逢何必曾相识！<br>我从去年辞帝京，谪居卧病浔阳城。<br>浔阳地僻无音乐，终岁不闻丝竹声。<br>住近湓江地低湿，黄芦苦竹绕宅生。<br>其间旦暮闻何物？杜鹃啼血猿哀鸣。<br>春江花朝秋月夜，往往取酒还独倾。<br>岂无山歌与村笛？呕哑嘲哳难为听。<br><strong>今夜闻君琵琶语，如听仙乐耳暂明。</strong><br><strong>莫辞更坐弹一曲，为君翻作《琵琶行》。</strong><br>感我此言良久立，却坐促弦弦转急。<br>凄凄不似向前声，满座重闻皆掩泣。<br>座中泣下谁最多？江州司马青衫湿。</p><h2 id="短歌行"><a href="#短歌行" class="headerlink" title="短歌行"></a>短歌行</h2><p>东汉 曹操<br>对酒当歌，人生几何！譬如朝露，去日苦多。<br>慨当以慷，忧思难忘。何以解忧？唯有杜康。<br>青青子衿，悠悠我心。<strong>但为君故，沉吟至今。</strong><br>呦呦鹿鸣，食野之苹。我有嘉宾，鼓瑟吹笙。<br>明明如月，何时可掇？忧从中来，不可断绝。<br>越陌度阡，枉用相存。契阔谈䜩，心念旧恩。(谈䜩 一作：谈宴)<br>月明星稀，乌鹊南飞。绕树三匝，何枝可依？<br>山不厌高，海不厌深。周公吐哺，天下归心。(海 一作：水)</p><h2 id="送杜少府之任蜀州"><a href="#送杜少府之任蜀州" class="headerlink" title="送杜少府之任蜀州"></a>送杜少府之任蜀州</h2><p>唐 王勃<br>城阙辅三秦，风烟望五津。<br><strong>与君离别意，同是宦游人。</strong><br>海内存知己，天涯若比邻。<br>无为在歧路，儿女共沾巾。</p><h2 id="送元二使安西"><a href="#送元二使安西" class="headerlink" title="送元二使安西"></a>送元二使安西</h2><p>唐 王维<br>渭城朝雨浥轻尘，客舍青青柳色新。<br><strong>劝君更尽一杯酒，西出阳关无故人。</strong></p><h2 id="夜雨寄北"><a href="#夜雨寄北" class="headerlink" title="夜雨寄北"></a>夜雨寄北</h2><p>唐 李商隐<br><strong>君问归期未有期，巴山夜雨涨秋池。</strong><br>何当共剪西窗烛，却话巴山夜雨时。</p><h2 id="凉州词"><a href="#凉州词" class="headerlink" title="凉州词"></a>凉州词</h2><p>唐 王翰<br>葡萄美酒夜光杯，欲饮琵琶马上催。<br><strong>醉卧沙场君莫笑，古来征战几人回？</strong></p><h2 id="饮酒·其五"><a href="#饮酒·其五" class="headerlink" title="饮酒·其五"></a>饮酒·其五</h2><p>魏晋 陶渊明<br>结庐在人境，而无车马喧。<br><strong>问君何能尔？心远地自偏。</strong><br>采菊东篱下，悠然见南山。<br>山气日夕佳，飞鸟相与还。<br>此中有真意，欲辨已忘言。</p><h2 id="卜算子·我住长江头"><a href="#卜算子·我住长江头" class="headerlink" title="卜算子·我住长江头"></a>卜算子·我住长江头</h2><p>宋 李之仪<br><strong>我住长江头，君住长江尾。日日思君不见君，共饮长江水。</strong><br>此水几时休，此恨何时已。<strong>只愿君心似我心，定不负相思意。</strong></p><h2 id="采薇"><a href="#采薇" class="headerlink" title="采薇"></a>采薇</h2><p>先秦 佚名<br>采薇采薇，薇亦作止。曰归曰归，岁亦莫止。 靡室靡家，猃狁之故。不遑启居，猃狁之故。<br>采薇采薇，薇亦柔止。曰归曰归，心亦忧止。 忧心烈烈，载饥载渴。我戍未定，靡使归聘。<br>采薇采薇，薇亦刚止。曰归曰归，岁亦阳止。 王事靡盬，不遑启处。忧心孔疚，我行不来！<br>彼尔维何？维常之华。<strong>彼路斯何？君子之车。</strong> 戎车既驾，四牡业业。岂敢定居？一月三捷。<br>驾彼四牡，四牡骙骙。<strong>君子所依，小人所腓。</strong> 四牡翼翼，象弭鱼服。岂不日戒？猃狁孔棘！<br>昔我往矣，杨柳依依。今我来思，雨雪霏霏。 行道迟迟，载渴载饥。我心伤悲，莫知我哀！</p><h2 id="雁门太守行"><a href="#雁门太守行" class="headerlink" title="雁门太守行"></a>雁门太守行</h2><p>唐 李贺<br>黑云压城城欲摧，甲光向日金鳞开。<br>角声满天秋色里，塞上燕脂凝夜紫。<br>半卷红旗临易水，霜重鼓寒声不起。<br><strong>报君黄金台上意，提携玉龙为君死。</strong></p><h2 id="酬乐天扬州初逢席上见赠"><a href="#酬乐天扬州初逢席上见赠" class="headerlink" title="酬乐天扬州初逢席上见赠"></a>酬乐天扬州初逢席上见赠</h2><p>唐 刘禹锡<br>巴山楚水凄凉地，二十三年弃置身。<br>怀旧空吟闻笛赋，到乡翻似烂柯人。<br>沉舟侧畔千帆过，病树前头万木春。<br><strong>今日听君歌一曲，暂凭杯酒长精神。</strong></p><h2 id="闻王昌龄左迁龙标遥有此寄"><a href="#闻王昌龄左迁龙标遥有此寄" class="headerlink" title="闻王昌龄左迁龙标遥有此寄"></a>闻王昌龄左迁龙标遥有此寄</h2><p>唐 李白<br>杨花落尽子规啼，闻道龙标过五溪。<br><strong>我寄愁心与明月，随君直到夜郎西。</strong></p><h2 id="兵车行"><a href="#兵车行" class="headerlink" title="兵车行"></a>兵车行</h2><p>唐 杜甫<br>车辚辚，马萧萧，行人弓箭各在腰。<br>耶娘妻子走相送，尘埃不见咸阳桥。(耶娘 一作：爷娘)<br>牵衣顿足拦道哭，哭声直上干云霄。<br>道旁过者问行人，行人但云点行频。<br>或从十五北防河，便至四十西营田。<br>去时里正与裹头，归来头白还戍边。<br>边庭流血成海水，武皇开边意未已。<br><strong>君不闻，汉家山东二百州，千村万落生荆杞。</strong><br>纵有健妇把锄犁，禾生陇亩无东西。<br>况复秦兵耐苦战，被驱不异犬与鸡。<br>长者虽有问，役夫敢申恨？<br>且如今年冬，未休关西卒。<br>县官急索租，租税从何出？<br>信知生男恶，反是生女好。<br>生女犹得嫁比邻，生男埋没随百草。<br><strong>君不见，青海头，古来白骨无人收。</strong><br>新鬼烦冤旧鬼哭，天阴雨湿声啾啾！</p><h2 id="十五从军征"><a href="#十五从军征" class="headerlink" title="十五从军征"></a>十五从军征</h2><p>两汉 佚名</p><p>十五从军征，八十始得归。</p><p>道逢乡里人：家中有阿谁？</p><p><strong>遥看是君家，松柏冢累累。</strong></p><p>兔从狗窦入，雉从梁上飞。</p><p>中庭生旅谷，井上生旅葵。</p><p>舂谷持作饭，采葵持作羹。</p><p>羹饭一时熟，不知贻阿谁。</p><p>出门东向看，泪落沾我衣。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;君-飞花令&quot;&gt;&lt;a href=&quot;#君-飞花令&quot; class=&quot;headerlink&quot; title=&quot;君 飞花令&quot;&gt;&lt;/a&gt;君 飞花令&lt;/h1&gt;&lt;h2 id=&quot;将进酒&quot;&gt;&lt;a href=&quot;#将进酒&quot; class=&quot;headerlink&quot; title=&quot;将进酒&quot;&gt;&lt;/</summary>
      
    
    
    
    <category term="飞花令" scheme="http://example.com/categories/%E9%A3%9E%E8%8A%B1%E4%BB%A4/"/>
    
    
    <category term="诗词" scheme="http://example.com/tags/%E8%AF%97%E8%AF%8D/"/>
    
  </entry>
  
  <entry>
    <title>docker的简单使用（一）</title>
    <link href="http://example.com/2023/03/04/docker/"/>
    <id>http://example.com/2023/03/04/docker/</id>
    <published>2023-03-04T13:48:49.000Z</published>
    <updated>2023-03-05T22:42:58.271Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Docker-简单使用（一）"><a href="#Docker-简单使用（一）" class="headerlink" title="Docker 简单使用（一）"></a>Docker 简单使用（一）</h1><p>近些日子都在忙于毕业设计，当中遇到了一些需要部署环境的过程。恰巧之前购买过Poulton的深入浅出学习docker，就希望能利用dockr来完成这些事情。</p><h2 id="1-在ArchLinux下安装docker"><a href="#1-在ArchLinux下安装docker" class="headerlink" title="1.在ArchLinux下安装docker"></a>1.在ArchLinux下安装docker</h2><ol><li><p>安装Docker</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查找Docker</span></span><br><span class="line">sudo pacman —Ss docker</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安装Docker</span></span><br><span class="line">sudo pacman -S docker</span><br></pre></td></tr></table></figure></li><li><p>开启Docker服务</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">开启Docker服务</span></span><br><span class="line">sudo systemctl start docker</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">开机自启动服务</span></span><br><span class="line">sudo systemctl enable docker</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查询Docker服务运行状态</span></span><br><span class="line">sudo systemctl status docker</span><br></pre></td></tr></table></figure></li><li><p>添加当前用户到docker用户组</p><blockquote><p>Docker守护程序绑定到Unix套接字而不是TCP端口。默认情况下，该用户拥有Unix套接字root，其他用户只能使用来访问它sudo。Docker守护程序始终以root用户身份运行。<br>如果你不想在前言docker与命令sudo，创建一个名为UNIX组docker和用户添加到它。当Docker守护程序启动时，它将创建一个可由该docker组成员访问的Unix套接字。  </p></blockquote><p>执行以下命令解决该问题：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看当前系统有哪些组，里边有docker组，验证docker是否有当前用户</span></span><br><span class="line">sudo cat /etc/group</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">添加docker用户组</span></span><br><span class="line">sudo groupadd docker</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">检测当前用户是否已经在docker用户组当中,没有就会添加，<span class="variable">$USER</span> 是你的用户名</span></span><br><span class="line">sudo gpasswd -a $USER docker</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">更新用户组</span></span><br><span class="line">newgrp docker</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">重启docker服务</span></span><br><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure></li><li><p>验证Docker安装状态</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看安装版本</span></span><br><span class="line">docker version</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看Docker信息</span></span><br><span class="line">docker info</span><br></pre></td></tr></table></figure></li></ol><p><img src="https://s2.loli.net/2023/03/05/C2rPpR9cMlw1OzY.png"></p><p><img src="https://s2.loli.net/2023/03/05/NmVhnEGiZvbPQ7A.png">如图所示即安装成功。</p><h2 id="2-镜像拉取与删除"><a href="#2-镜像拉取与删除" class="headerlink" title="2.镜像拉取与删除"></a>2.镜像拉取与删除</h2><ol><li><p>Docker主机在下载完成之初是没有本地镜像的（通常存放在&#x2F;var&#x2F;lib&#x2F;docker&#x2F;<storage-driver>），需要在Docker Hub中进行Pull（拉取）。大部分流行的操作系统和应用在官方的仓库都可以找到对应的镜像。只需要知道命名与标签就可以在官方仓库中定位：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">拉取格式</span></span><br><span class="line">docker image pull &lt;repository&gt;:&lt;tag&gt;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">从官方拉取带有latest标签的Ubuntu镜像, 注意这个laetst标签并不代表一定是最新的镜像。比如Alpine的最新镜像的标签通常是edge</span></span><br><span class="line">docker image pull ubuntu:latest</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/03/05/MzGHtSemCNopPQj.png" alt="image-20230303135815253"></p></li><li><p>Docker的镜像是通过堆叠镜像层来构成的，若需要详细查看则输入以下命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker image inspect ubuntu:latest</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/03/05/fH2mFpheaDjydsx.png" alt="image-20230303140930881"></p></li><li><p>镜像删除</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker image rm ubuntu:lates</span><br></pre></td></tr></table></figure></li></ol><h2 id="3-运行容器"><a href="#3-运行容器" class="headerlink" title="3.运行容器"></a>3.运行容器</h2><h3 id="检测Docker-daemon是否运行"><a href="#检测Docker-daemon是否运行" class="headerlink" title="检测Docker daemon是否运行"></a>检测Docker daemon是否运行</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl is-active docker</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">若返回 active 则在运行</span></span><br></pre></td></tr></table></figure><h3 id="启动容器"><a href="#启动容器" class="headerlink" title="启动容器"></a>启动容器</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker container run -it ubuntu:latest /bin/bash</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/03/05/mV4hHlnjPeC2oBi.png" alt="image-20230303142749947"></p><p>出现root@81d12951edb0表明已经进入容器运行。@后边的12位字符是容器唯一ID的前12位字符。</p><h3 id="容器进程"><a href="#容器进程" class="headerlink" title="容器进程"></a>容器进程</h3><p>通过输入</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -elf</span><br></pre></td></tr></table></figure><p>可以看到：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">F S UID          PID    PPID  C PRI  NI ADDR SZ WCHAN  STIME TTY          TIME CMD</span><br><span class="line">4 S root           1       0  0  80   0 -  1156 do_wai 13:27 pts/0    00:00:00 /bi</span><br><span class="line">4 R root          17       1  0  80   0 -  1765 -      13:36 pts/0    00:00:00 ps </span><br></pre></td></tr></table></figure><p>上边看起来有俩个进程，但实际上第二个进程是我们使用查询命令生成的临时进程。也就是说容器只运行了一个进程 &#x2F;bin&#x2F;bash。 如果输入exit来退出进程。也就是容器也会被销毁掉。如果用 Ctrl+PQ的组合按键，将容器放在后台运行。</p><p>此时</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker container stop ubuntu</span><br><span class="line">docker container rm ubuntu</span><br></pre></td></tr></table></figure><p>即可优雅的停止并删除容器。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Docker-简单使用（一）&quot;&gt;&lt;a href=&quot;#Docker-简单使用（一）&quot; class=&quot;headerlink&quot; title=&quot;Docker 简单使用（一）&quot;&gt;&lt;/a&gt;Docker 简单使用（一）&lt;/h1&gt;&lt;p&gt;近些日子都在忙于毕业设计，当中遇到了一些需要</summary>
      
    
    
    
    <category term="计算机技术" scheme="http://example.com/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="计算机技术" scheme="http://example.com/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%8A%80%E6%9C%AF/"/>
    
  </entry>
  
  <entry>
    <title>又一次见面，真好</title>
    <link href="http://example.com/2023/03/04/test/"/>
    <id>http://example.com/2023/03/04/test/</id>
    <published>2023-03-04T11:22:41.000Z</published>
    <updated>2023-03-04T14:01:58.287Z</updated>
    
    <content type="html"><![CDATA[<h1 id="新的一天"><a href="#新的一天" class="headerlink" title="新的一天"></a>新的一天</h1><p><img src="/home/mxvivi/Blog/public/img/bg-11.jpg"></p><p>之前使用过的wordpress由于没有继续为服务器续费就停止使用啦。现在Hexo与github上又随缘的弄了一下博客。记录一下我做的毕业设计吧。</p>]]></content>
    
    
    <summary type="html">我是潇潇潇</summary>
    
    
    
    
    <category term="test" scheme="http://example.com/tags/test/"/>
    
  </entry>
  
</feed>
